"""
https://stepik.org/lesson/933767/step/18?unit=939666

ÐšÐ»Ð°ÑÑ TreeBuilder ðŸŒ¶ï¸ðŸŒ¶ï¸
Ð”ÐµÑ€ÐµÐ²Ð¾ â€” Ð¾Ð´Ð½Ð° Ð¸Ð· Ð½Ð°Ð¸Ð±Ð¾Ð»ÐµÐµ ÑˆÐ¸Ñ€Ð¾ÐºÐ¾ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ñ… ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸ÐºÐµ, ÑÐ¼ÑƒÐ»Ð¸Ñ€ÑƒÑŽÑ‰Ð°Ñ Ð´Ñ€ÐµÐ²Ð¾Ð²Ð¸Ð´Ð½ÑƒÑŽ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð² Ð²Ð¸Ð´Ðµ Ð½Ð°Ð±Ð¾Ñ€Ð° ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ñ… ÑƒÐ·Ð»Ð¾Ð².

Ð­Ð»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´ÐµÑ€ÐµÐ²Ð° Ð½Ð°Ð·Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ ÑƒÐ·Ð»Ð°Ð¼Ð¸. ÐÐ° Ñ€Ð¸ÑÑƒÐ½ÐºÐµ Ð²Ñ‹ÑˆÐµ ÑƒÐ·Ð»Ð°Ð¼Ð¸ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ 8, 3, 1, 6, 4, 7, 10, 14 Ð¸ 13. Ð£Ð·Ð»Ñ‹ Ð±ÐµÐ· Ð¿Ð¾Ñ‚Ð¾Ð¼ÐºÐ¾Ð² Ð½Ð°Ð·Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ð»Ð¸ÑÑ‚ÑŒÑÐ¼Ð¸. ÐÐ° Ñ€Ð¸ÑÑƒÐ½ÐºÐµ Ð²Ñ‹ÑˆÐµ Ð»Ð¸ÑÑ‚ÑŒÑÐ¼Ð¸ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ 1, 4, 7 Ð¸ 13.

Ð ÐµÐ°Ð»Ð¸Ð·ÑƒÐ¹Ñ‚Ðµ ÐºÐ»Ð°ÑÑ TreeBuilder. ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€Ð° ÐºÐ»Ð°ÑÑ Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð½Ð¸ÐºÐ°ÐºÐ¸Ñ… Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð².

Ð­ÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ ÐºÐ»Ð°ÑÑÐ° TreeBuilder Ð´Ð¾Ð»Ð¶ÐµÐ½ ÑÐ²Ð»ÑÑ‚ÑŒÑÑ Ñ€ÐµÐµÐ½Ñ‚ÐµÑ€Ð°Ð±ÐµÐ»ÑŒÐ½Ñ‹Ð¼ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¼ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾ÑˆÐ°Ð³Ð¾Ð²Ð¾ ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð´Ñ€ÐµÐ²Ð¾Ð²Ð¸Ð´Ð½ÑƒÑŽ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð´ÐµÑ€ÐµÐ²Ð¾).

ÐšÐ»Ð°ÑÑ TreeBuilder Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¸Ð¼ÐµÑ‚ÑŒ Ð´Ð²Ð° Ð¼ÐµÑ‚Ð¾Ð´Ð° ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€Ð°:

add() â€” Ð¼ÐµÑ‚Ð¾Ð´, Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÑŽÑ‰Ð¸Ð¹ Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚ (Ð»Ð¸ÑÑ‚) Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ð¹ ÐµÐ³Ð¾ Ð² Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑƒÐ·ÐµÐ» Ð´ÐµÑ€ÐµÐ²Ð°
structure() â€” Ð¼ÐµÑ‚Ð¾Ð´, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‰Ð¸Ð¹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð´ÐµÑ€ÐµÐ²Ð° Ð² Ð²Ð¸Ð´Ðµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ñ… ÑÐ¿Ð¸ÑÐºÐ¾Ð²
Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑƒÐ·Ð»Ð¾Ð² Ð² Ð´ÐµÑ€ÐµÐ²Ð¾ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° with. Ð£Ð·ÐµÐ» ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¼ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… ÑÐ²Ð¾ÐµÐ³Ð¾ Ð±Ð»Ð¾ÐºÐ° with. Ð•ÑÐ»Ð¸ Ð² ÑƒÐ·ÐµÐ» Ð½Ðµ Ð±Ñ‹Ð»Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð¸ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð»Ð¸ÑÑ‚Ð°, Ñ‚Ð¾ ÑÑ‚Ð¾Ñ‚ ÑƒÐ·ÐµÐ» Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾ÑÐ²Ð»ÑÑ‚ÑŒÑÑ Ð² ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ðµ Ð´ÐµÑ€ÐµÐ²Ð°, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼Ð¾Ð¹ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ structure().

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 1. Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð´ÐµÑ€ÐµÐ²Ð° Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð»ÑŒÐ½Ð¾Ð¹, Ñ‚Ð¾ ÐµÑÑ‚ÑŒ ÑƒÐ·ÐµÐ» Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ ÑƒÐ·ÐµÐ», Ñ‚Ð¾Ñ‚, Ð² ÑÐ²Ð¾ÑŽ Ð¾Ñ‡ÐµÑ€ÐµÐ´ÑŒ, Ð´Ñ€ÑƒÐ³Ð¾Ð¹, Ð¸ Ñ‚Ð°Ðº Ð´Ð°Ð»ÐµÐµ.

ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ 2. Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ, Ñ‡Ñ‚Ð¾ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð´ÐµÑ€ÐµÐ²Ð° Ð½Ðµ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð±Ð»Ð¾ÐºÐ¾Ð² with, Ñ‚Ð¾ ÐµÑÑ‚ÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð´ÐµÑ€ÐµÐ²Ð° Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð»Ð¸ÑˆÑŒ Ð¿Ð¾ÑÐ»Ðµ ÐµÐµ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ.
"""
# #my_first_solution
class TreeBuilder:
    level = -1
    tree = []

    def __init__(self):
        self.tmp = dict()

    def __enter__(self):
        type(self).level += 1
        self.tmp[type(self).level] = []
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        if not self.tmp[type(self).level]:
            del self.tmp[type(self).level]
        if type(self).level > 0:
            try:
                self.tmp[type(self).level - 1].append(self.tmp[type(self).level])
            except:
                pass
        else:
            type(self).tree.append(self.tmp[type(self).level])
        type(self).level -= 1

    def add(self, obj):
        if self.level < 0:
            type(self).tree.append(obj)
        else:
            self.tmp[type(self).level].append(obj)

    def structure(self):
        return type(self).tree


#best practices, using stack

# class TreeBuilder:
#     def __init__(self):
#         self.knots = [[]]
#
#     def __enter__(self):
#         self.knots.append([])
#
#     def __exit__(self, *args, **kwargs):
#         if self.knots[-1]:
#             self.knots[-2].append(self.knots[-1])
#         self.knots.pop()
#
#     def add(self, value):
#         self.knots[-1].append(value)
#
#     def structure(self):
#         return self.knots[-1]
